<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OpenCode Chatbot</title>
  <link rel="stylesheet" href="/styles.css" />
  <!-- Highlight.js for code syntax highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <!-- Marked.js for markdown rendering -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/15.0.0/marked.min.js"></script>
  <!-- DOMPurify for XSS protection on rendered markdown -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.2.4/purify.min.js"></script>
</head>
<body>
  <div id="app">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 18l6-6-6-6"/><path d="M8 6l-6 6 6 6"/>
          </svg>
          <span>OpenCode Chat</span>
        </div>
        <button class="btn-icon" id="newChatBtn" title="New Chat">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14"/>
          </svg>
        </button>
      </div>
      <div class="sidebar-sessions" id="sessionList">
        <!-- Sessions populated dynamically -->
      </div>
      <div class="sidebar-footer">
        <div class="status-indicator" id="serverStatus">
          <span class="status-dot"></span>
          <span class="status-text">Connecting...</span>
        </div>
      </div>
    </aside>

    <!-- Main Chat Area -->
    <main class="chat-main">
      <!-- Top Bar -->
      <header class="chat-header">
        <button class="btn-icon sidebar-toggle" id="sidebarToggle">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12h18M3 6h18M3 18h18"/>
          </svg>
        </button>
        <div class="chat-title" id="chatTitle">New Conversation</div>
        <div class="header-actions">
          <button class="btn-icon" id="themeToggle" title="Toggle Theme">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
          </button>
        </div>
      </header>

      <!-- Messages Area -->
      <div class="messages-container" id="messagesContainer">
        <div class="messages" id="messages">
          <!-- Welcome screen -->
          <div class="welcome-screen" id="welcomeScreen">
            <div class="welcome-icon">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M16 18l6-6-6-6"/><path d="M8 6l-6 6 6 6"/>
              </svg>
            </div>
            <h1>OpenCode Chatbot</h1>
            <p>Powered by OpenCode Server with Copilot</p>
            <div class="quick-actions">
              <button class="quick-action" data-prompt="Help me write a Python script to process CSV files">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z"/><path d="M13 2v7h7"/></svg>
                Write Python script
              </button>
              <button class="quick-action" data-prompt="Review my code for potential security issues">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                Code review
              </button>
              <button class="quick-action" data-prompt="Explain how Docker networking works">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>
                Explain concepts
              </button>
              <button class="quick-action" data-prompt="Help me debug this error message">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h.01"/><path d="M8.5 16.5A5 5 0 0112 15a5 5 0 013.5 1.5"/><path d="M2 8.82a15 15 0 014.37-2.32M22 8.82a15 15 0 00-4.37-2.32"/></svg>
                Debug errors
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Input Area -->
      <div class="input-area">
        <div class="input-wrapper">
          <textarea
            id="messageInput"
            placeholder="Type your message... (Enter to send, Shift+Enter for new line)"
            rows="1"
          ></textarea>
          <button class="send-btn" id="sendBtn" disabled>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 2L11 13"/><path d="M22 2l-7 20-4-9-9-4 20-7z"/>
            </svg>
          </button>
        </div>
        <div class="input-footer">
          <span>OpenCode Server + Copilot</span>
        </div>
      </div>
    </main>
  </div>

  <script src="/app.js"></script>
</body>
</html>
